# Admin Guide - Christmas Bird Count Registration System
<!-- Created by Claude AI on 2025-10-10 -->

This guide covers using the admin interface to manage participants, assign area leaders, and coordinate your Christmas Bird Count registration.

## <h1 style="color: red;">CAUTION</h1>
<em style="color: red;">All original code and much of the documentation was generated by Claude.ai in response to prompts from Harvey Dueck.

Like every AI I've tried, Claude is prone to making exaggerated claims, stating that a test suite for a single feature
is "comprehensive", that some very sloppy code is "professional", or that something is "production ready" when it hasn't 
been tested yet.  Don't trust such value judgements in documentation
or code comments.  As of 10.10.2025 when I'm checking this in, I haven't yet had time to carefully review the documentation.
It's included in the hope that it will be useful, even if it's incomplete and occasionally inaccurate.
</em>

## Table of Contents

- [Accessing the Admin Interface](#accessing-the-admin-interface)
- [Dashboard Overview](#dashboard-overview)
- [Managing Participants](#managing-participants)
- [Managing Area Leaders](#managing-area-leaders)
- [Handling Unassigned Participants](#handling-unassigned-participants)
- [Exporting Data](#exporting-data)
- [Working with Historical Data](#working-with-historical-data)
- [Email Notifications](#email-notifications)
- [Common Tasks](#common-tasks)

## Accessing the Admin Interface

### Login Process

1. Navigate to your admin URL (e.g., `https://cbc-registration.yourclub.org/admin`)
2. Click "Sign in with Google"
3. Authenticate with your Google account
4. Your email must be in the admin whitelist (`config/admins.py`)

**Note**: Only whitelisted admin accounts can access the admin interface. If you need admin access, contact your system administrator.

### Admin Access Requirements

- Google account
- Email address listed in the admin configuration
- Internet connection

## Dashboard Overview

The admin dashboard is your central hub for managing the count. It displays:

### Key Statistics
- **Total Participants**: Current year's registration count
- **Assigned vs Unassigned**: How many participants have been assigned to areas
- **Areas Needing Leaders**: Count of areas without designated leaders

### Recent Registrations
- Latest 10 participant registrations
- Quick view of new sign-ups
- Links to participant details

### Quick Actions
- **Export Participants CSV**: Download complete participant list
- **Export Leaders CSV**: Download area leader contact information
- **View Unassigned**: Jump to unassigned participant management
- **Manage Leaders**: Access leader assignment interface

### Year Selector
- Dropdown to switch between current and historical years
- Current year is the default view
- Historical years are marked with an archive icon and orange text

## Managing Participants

### Viewing Participants

Navigate to **Admin > Participants** to see all registered participants.

**Organization:**
- Participants grouped by count area (A, B, C, etc.)
- Separate sections for regular participants and FEEDER counters
- Jump links at top of page for quick navigation to specific areas
- Participant count displayed in each area header

**Year Tabs:**
- Current year tab: Full editing capabilities
- Historical year tabs: Read-only view with orange background

### Participant Information Display

Each participant entry shows:
- **Name**: First and last name
- **Contact**: Email (clickable mailto link), cell phone, secondary phone
- **Experience**: Skill level badge, CBC experience
- **Equipment**: Binoculars and spotting scope icons
- **Notes**: Truncated to 50 characters (hover for full text)
- **Interests**: Leadership and scribe role interest indicators
- **Actions**: Edit, Reassign, Delete buttons (current year only)

### Editing Participant Information

**To edit a participant (current year only):**

1. Click the pencil icon in the Actions column
2. Form fields become editable:
   - First name, last name
   - Email address
   - Cell phone, secondary phone
   - Skill level, CBC experience
   - Equipment checkboxes (binoculars, spotting scope)
   - Notes to organizers
   - Leadership interest, scribe interest
3. Make your changes
4. Click **Save** to update (or **Cancel** to discard)

**Important**: Only fields you modify are updated. All other participant data remains unchanged.

### Reassigning Participants

**To move a participant to a different area:**

1. Click the **Reassign** button in the Actions column
2. Select the new area from the dropdown menu
3. Click **Confirm** (or **Cancel**)

**If reassigning a leader:**
- A modal dialog will appear with three options:
  - **Leader**: Move participant and make them leader of the new area (removes previous leadership)
  - **Team Member**: Move participant without leadership status
  - **Cancel**: Don't move the participant

**Validation:**
- Cannot reassign to the same area
- All participant information is preserved during reassignment
- Page automatically refreshes to show updated assignment

### Deleting Participants

**To remove a participant:**

1. Click the trash icon in the Actions column
2. Enter a reason for removal in the confirmation dialog
3. Click **OK** to confirm (or **Cancel**)

**What happens:**
- Participant record is deleted from the database
- If participant is a leader, their leadership is removed
- Removal is logged with your admin email and reason
- Action cannot be undone (data is permanently deleted)

## Managing Area Leaders

Navigate to **Admin > Leaders** to manage area leader assignments.

### Interactive Map

The leaders page includes an interactive map showing:
- **Red areas**: Areas needing leaders
- **Green areas**: Areas with assigned leaders
- **Tooltips**: Hover over green areas to see leader names
- **Legend**: Count of areas with/without leaders

### Current Leaders Table

Displays all assigned leaders with:
- Area assignment
- Leader name (first and last)
- Email address
- Cell phone
- Secondary phone
- Edit and delete actions

**Sorting**: Leaders are sorted by area code, then by first name.

### Editing Leader Information

**To edit a leader:**

1. Click the pencil icon next to the leader
2. All fields become editable simultaneously:
   - Area dropdown
   - First name, last name
   - Email address
   - Cell phone, secondary phone
3. Make changes
4. Click **Save** (or **Cancel**)

**Business rules enforced:**
- One area maximum per person (checked by name + email combination)
- Required fields: first name, last name, email, cell phone
- Map updates automatically after successful save

### Removing Leader Status

**To remove a leader:**

1. Click the trash icon next to the leader
2. Confirm the deletion

**What happens:**
- Leadership status removed from participant record
- Participant remains registered but is no longer a leader
- Map updates automatically

### Adding Leaders

**Two methods for adding leaders:**

#### Method 1: Manual Entry (Primary)

Use the **"Add New Leader"** form:

1. Select area from dropdown
2. Enter first name, last name
3. Enter email address
4. Enter cell phone number
5. Optionally enter secondary phone
6. Click **Add Leader**

**Result**: Creates a new participant record with leadership status.

#### Method 2: Promote Existing Participant

Use the **"Potential Leaders"** table:

1. Find participant who indicated leadership interest
2. Review their skill level and preferred area
3. Click **Promote to Leader** button
4. Select area for leadership assignment
5. Confirm

**Result**: Updates existing participant record with leadership status and reassigns to their led area.

### Areas Needing Leaders

Below the map, you'll see a list of areas currently without leaders. Click any area code to jump to that area's participant list.

## Handling Unassigned Participants

Navigate to **Admin > Unassigned** to manage participants who selected "Wherever I'm needed most".

### Unassigned List

Displays participants waiting for area assignment with:
- Name and contact information
- Skill level and experience
- Equipment availability
- Leadership and scribe interest
- Notes to organizers

### Assigning Participants

**To assign a participant:**

1. Locate the participant in the list
2. Click the **Assign** button
3. Select an area from the dropdown (shows current participant counts)
4. Click **Confirm**

**Tips:**
- Consider participant's skill level when assigning
- Balance team sizes across areas
- Note equipment availability (binoculars, spotting scope)
- Check leadership interest for potential future leaders

### Area Capacity Overview

The top of the page shows all areas with current participant counts, color-coded to help balance assignments.

## Exporting Data

### CSV Export Options

**Participant Export:**
- Click **Export Participants CSV** from dashboard or participants page
- Downloads complete participant list with all registration data
- Filename format: `cbc_participants_YYYY_MMDD.csv`
- Sorted by area, then participation type, then first name

**Leader Export:**
- Click **Export Leaders CSV** from dashboard or leaders page
- Downloads area leader contact information with full participant details
- Filename format: `area_leaders_YYYY_MMDD.csv`
- Sorted by area, then first name

**Year Selection:**
- Export buttons available on both current and historical year views
- Exports data for the currently selected year

### CSV Data Fields

Participant export includes:
- Personal information (name, email, phones)
- Area assignment
- Experience and skill level
- Participation type (regular/FEEDER)
- Equipment availability
- Leadership and scribe interest
- Notes to organizers
- Registration timestamp

## Working with Historical Data

### Accessing Historical Years

Use the year selector at the top of any admin page:
- Dropdown shows current year + past 3 years with data
- Select a year to view that year's data
- Historical years marked with orange text and archive icon

### Historical Data Restrictions

**Read-Only Access:**
- Historical year data cannot be edited
- Edit and delete buttons are hidden
- "Read-only" text appears in actions column
- Orange background tint on all data cards

**Available Actions:**
- View participant information
- Export CSV files
- Review area assignments
- Check historical team compositions

**Use Cases:**
- Recruiting previous participants
- Planning area assignments based on past participation
- Analyzing trends over multiple years
- Maintaining contact with returning volunteers

## Email Notifications

### Automated Email System

The system sends automated emails to area leaders and admins:

**Team Updates (Twice Daily):**
- Sent when team composition changes
- Includes new members, removed members, current roster
- Delivered at 6am and 6pm (configurable timezone)

**Weekly Summaries:**
- Sent to leaders with no team changes
- Delivered every Friday at 11pm
- Includes current team roster

**Admin Digest:**
- Daily summary of unassigned participants
- Sent to all admins at 6pm
- Only sent when unassigned participants exist

### Test Mode (Test Server Only)

On test deployments, the admin dashboard includes email testing buttons:
- **Test Team Updates**: Send test email to yourself
- **Test Weekly Summary**: Send test email to yourself
- **Test Admin Digest**: Send test email to yourself

These buttons only appear on test servers. All test emails are redirected to the configured test recipient email.

## Common Tasks

### Setting Up for a New Count Year

1. **Verify Admin Access**: Ensure all count coordinators have admin access
2. **Review Area Configuration**: Check that all areas are correctly defined
3. **Assign Initial Leaders**: Set up returning area leaders before registration opens
4. **Test Registration**: Create test registrations to verify the system works
5. **Export Historical Data**: Download previous year's data for reference

### During Registration Period

1. **Monitor Dashboard**: Check registration counts regularly
2. **Assign Unassigned Participants**: Review and assign participants daily
3. **Coordinate with Leaders**: Respond to questions about team assignments
4. **Export Data**: Download CSV files for offline communication
5. **Manage Team Changes**: Reassign participants as needed

### Post-Registration

1. **Final Team Assignments**: Ensure all participants are assigned
2. **Export Final Rosters**: Download CSV files for count day coordination
3. **Verify Leader Information**: Confirm all areas have designated leaders
4. **Archive Data**: Historical data automatically becomes read-only for next year

### Troubleshooting Common Issues

**Participant can't register:**
- Check if they previously registered (duplicate emails blocked)
- Verify FEEDER participants selected a specific area (not "Wherever needed")
- Check browser console for JavaScript errors

**Leader not receiving emails:**
- Verify their email address is correct in the system
- Check spam/junk folders
- Confirm email scheduler is configured (production only)

**Can't edit historical data:**
- This is by design - historical years are read-only
- Create new registration in current year if participant is returning

**CSV export doesn't include all fields:**
- All defined fields should be included automatically
- If fields are missing, contact system administrator

## Getting Help

**For technical issues:**
- Check server logs for error messages
- Review [DEPLOYMENT.md](DEPLOYMENT.md) for configuration issues
- File issues on GitHub for bugs

**For system questions:**
- Review [SPECIFICATION.md](SPECIFICATION.md) for how features work
- Check [DEVELOPER_GUIDE.md](DEVELOPER_GUIDE.md) for customization

**For participant questions:**
- Most participants won't need instructions - registration is straightforward
- Area leaders should refer to [LEADER_GUIDE.md](LEADER_GUIDE.md)

---

**Questions or suggestions?** File an issue on the [GitHub repository](https://github.com/naturevancouver/christmas-bird-count-registration/issues).
